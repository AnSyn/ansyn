<ng-container *ngFor="let featureId of selection">
	<div class="context-menu-wrapper"
		 *ngIf="annotations?.idToEntity?.has(featureId)"
		 [ngStyle]="calcBoundingRect(featureId)">

		<div class="context-menu" [style.outline-color]="getFeatureProps(featureId)?.style?.initial?.stroke">
			<ul class="buttons">
				<li>
					<button [class.active]="getFeatureProps(featureId)?.showMeasures"
							(click)="toggleMeasures(featureId)">
						<i [attr.tooltip-value]="'Measures' | translate" tooltip-class="bottom">
							<svg fill="#fff">
								<path d="M21.888 15.328l1.888-1.888-2.336-2.368c-0.256-0.256-0.256-0.672 0-0.928s0.672-0.256 0.928 0l2.368 2.336 1.888-1.888-4.704-4.704-16.032 16.032 4.704 4.704 1.888-1.888-2.368-2.336c-0.256-0.256-0.256-0.704 0-0.96s0.704-0.256 0.96 0l2.336 2.368 1.888-1.888-1.408-1.408c-0.256-0.256-0.256-0.672 0-0.96 0.256-0.256 0.672-0.256 0.96 0l1.408 1.44 1.888-1.888-2.368-2.368c-0.256-0.256-0.256-0.672 0-0.928 0.256-0.288 0.672-0.288 0.928 0l2.368 2.336 1.888-1.888-1.408-1.408c-0.256-0.256-0.256-0.672 0-0.928s0.672-0.256 0.928 0l1.408 1.408zM21.44 4.48c0.256-0.256 0.672-0.256 0.96 0l5.632 5.632c0.256 0.288 0.256 0.704 0 0.96l-16.96 16.96c-0.256 0.256-0.672 0.256-0.928 0l-5.664-5.664c-0.256-0.256-0.256-0.672 0-0.928l16.96-16.96z"></path>
							</svg>
						</i>
					</button>
				</li>
				<li>
					<button [class.active]="selectedTab[featureId] === Tabs.Label"
							(click)="selectTab(featureId, Tabs.Label)">
						<i [attr.tooltip-value]="'Label' | translate" tooltip-class="bottom">
							<svg >
								<path d="M16.608 6.912l7.68 0.16c0.384 0.032 0.672 0.32 0.672 0.672l0.16 7.68c0 0.192-0.064 0.384-0.192 0.512l-9.44 9.408c-0.256 0.256-0.672 0.256-0.928 0l-7.872-7.84c-0.256-0.256-0.256-0.704 0-0.96l9.44-9.408c0.128-0.128 0.288-0.224 0.48-0.224zM16.864 8.256l-8.768 8.768 6.912 6.912 8.768-8.768-0.128-6.752-6.784-0.16zM17.696 11.52c0.768-0.768 2.048-0.768 2.816 0 0.8 0.768 0.8 2.048 0 2.816-0.768 0.8-2.048 0.8-2.816 0-0.8-0.768-0.8-2.048 0-2.816zM19.584 12.48c-0.256-0.288-0.704-0.288-0.96 0-0.256 0.256-0.256 0.672 0 0.928s0.704 0.256 0.96 0c0.256-0.256 0.256-0.672 0-0.928z"></path>
							</svg>
						</i>
					</button>

					<form class="annotation-label-edit"
						  *ngIf="selectedTab[featureId] === Tabs.Label"
						  (ngSubmit)="labelInput.blur()">

						<mat-form-field class="label-form-field">
							<input matInput
								   type="text"
                                   #labelInput
								   autofocus
								   [placeholder]="'Label' | translate"
								   name="EditLabel"
								   [ngModel]="getFeatureProps(featureId)?.label"
								   (ngModelChange)="updateLabel($event, featureId)">
						</mat-form-field>

					</form>
				</li>
				<li class="expanded-selection line-width-selection">
					<p>
						<button [class.active]="selectedTab[featureId] === Tabs.Weight"
								(click)="selectTab(featureId, Tabs.Weight)">
							<i [attr.tooltip-value]="'Width' | translate" tooltip-class="bottom">
								<svg>
									<path d="M5.344 21.632v-1.312h21.312v1.312h-21.312zM5.344 24.608v-0.64h21.312v0.64h-21.312zM5.344 18.304v-1.984h21.312v1.984h-21.312zM5.344 13.984v-2.656h21.312v2.656h-21.312zM5.344 9.344v-4h21.312v4h-21.312z"></path>
								</svg>
							</i>
						</button>
						<ansyn-annotations-weight
							[show]="selectedTab[featureId] === Tabs.Weight"
							[properties]="getFeatureProps(featureId)?.style?.initial"
							(selectLineStyle)="selectLineWidth($event, featureId)">
						</ansyn-annotations-weight>
					</p>
				</li>
				<li>
					<p>
						<button [class.active]="selectedTab[featureId] === Tabs.Colors"
								[class.disabled]="isFeatureNonEditable(featureId)"
								(click)="selectTab(featureId, Tabs.Colors)">
							<i [attr.tooltip-value]="'Color' | translate" tooltip-class="bottom">
								<svg >
									<path d="M24.352 5.344c-0.64 0-1.216 0.224-1.632 0.704l-9.696 10.048c0 0 0 0 0 0s0 0 0 0l-2.144 2.208c-1.792 0.096-4.832 1.248-5.248 5.216-0.064 0.16-0.352 0.896-0.992 0.992-0.448 0.096-0.64 0.448-0.64 0.736 0.032 0.896 1.792 1.248 2.528 1.344 0.256 0.032 0.64 0.064 1.088 0.064 1.92 0 5.184-0.672 6.496-4.928l11.904-12.352c0.416-0.448 0.672-1.056 0.64-1.696 0-0.64-0.224-1.216-0.672-1.664s-1.024-0.672-1.632-0.672zM13.504 17.44l1.472 1.536-1.44 1.472-1.472-1.504 1.44-1.504zM9.568 25.088c-1.312 0.416-2.656 0.32-3.52 0.096 0.576-0.576 0.8-1.312 0.8-1.376 0.032-0.032 0.032-0.064 0.032-0.096 0.352-3.552 3.168-4.032 4.032-4.096l1.92 1.92c-0.608 1.824-1.696 3.040-3.264 3.552zM25.12 8.448l-9.248 9.6-1.504-1.504 9.248-9.6c0.384-0.416 1.088-0.416 1.472 0 0.192 0.192 0.32 0.448 0.32 0.736s-0.096 0.576-0.288 0.768z"></path>
								</svg>
							</i>
						</button>
						<ansyn-annotations-color
							[show]="selectedTab[featureId] === Tabs.Colors"
							[properties]="getFeatureProps(featureId)?.style?.initial"
							(colorChange)="colorChange($event, featureId)"
							(activeChange)="activeChange($event, featureId)"
						></ansyn-annotations-color>
					</p>
				</li>
				<li *ngIf="!getFeatureProps(featureId)?.undeletable">
					<button class='removeFeature' (click)="removeFeature(featureId)"
							[class.disabled]="isFeatureNonEditable(featureId)"
					>
						<i [attr.tooltip-value]="'Delete' | translate" tooltip-class="bottom">
							<svg >
								<path d="M12 11.296h2.656c0.384 0 0.672-0.288 0.672-0.64v-0.672h1.344v-0.64h-1.344v0.64h1.344v0.672c0 0.352 0.288 0.64 0.672 0.64h-5.344v10.688h8v-10.688h-8zM20.672 9.984v0h1.344c0.864 0 0.864 1.312 0 1.312h-0.672v11.36c0 0.352-0.32 0.64-0.672 0.64h-9.344c-0.352 0-0.672-0.288-0.672-0.64v-11.36h-0.64v-1.312h1.312c-0.352 0-0.672 0.288-0.672 0.672v0.64h-0.64c-0.896 0-0.896-1.312 0-1.312h4v-1.312c0-0.384 0.288-0.672 0.64-0.672h2.688c0.352 0 0.672 0.288 0.672 0.672v1.312h4v1.312h-0.672v-0.64c0-0.384-0.32-0.672-0.672-0.672zM14.016 13.984c0-0.352 0.288-0.64 0.64-0.64 0.384 0 0.672 0.288 0.672 0.64v5.344c0 0.384-0.288 0.672-0.672 0.672-0.352 0-0.64-0.288-0.64-0.672v-5.344zM18.016 19.328c0 0.384-0.32 0.672-0.672 0.672-0.384 0-0.672-0.288-0.672-0.672v-5.344c0-0.352 0.288-0.64 0.672-0.64 0.352 0 0.672 0.288 0.672 0.64v5.344z"></path>
							</svg>
						</i>
					</button>
				</li>
			</ul>
		</div>

	</div>
</ng-container>
<div class="context-menu-wrapper"
	 *ngIf="annotations?.idToEntity?.has(hoverFeatureId)"
	 [ngStyle]="calcBoundingRect(hoverFeatureId)">
	<div class="context-menu" [style.outline-color]="getFeatureProps(hoverFeatureId)?.style?.initial?.stroke"></div>
</div>
